import{K as z,Oa as Q,Wa as A,aa as H}from"./chunk-APBCXCJV.js";import{a as j,b as V}from"./chunk-2PWV3ZRO.js";import"./chunk-7NMITLUU.js";import{k as T,l as $,p as D,r as G}from"./chunk-X7Q72NDQ.js";import{$a as P,$b as _,Bb as l,Cb as n,Db as o,Eb as c,Ma as C,Oa as a,Pb as R,Rb as p,Ta as E,Ub as v,Vb as x,Wb as y,Xb as h,_b as f,ac as F,ea as d,eb as m,fa as S,gc as k,lc as I,nc as O,vb as b,yc as M}from"./chunk-Z4PMJ25B.js";var X=["rackContainer"],B=["switchElement"],W=["gpuElement"],Y=()=>[1,2,3,4,5,6,7,8],L=()=>[1,2,3];function q(r,t){if(r&1&&c(0,"div",15),r&2){let e=t.$implicit;h("animation-delay",e*100+"ms")}}function U(r,t){if(r&1&&(d(),c(0,"line",17)),r&2){let e=p().$implicit,i=p(2);b("x1",i.switchPos.x+"%")("y1",i.switchPos.y+"%")("x2",e.x+"%")("y2",e.y+"%")}}function J(r,t){if(r&1&&(d(),n(0,"g"),m(1,U,1,4,"line",16),o()),r&2){let e=t.$implicit;a(),l("ngIf",e.x&&e.y)}}function K(r,t){if(r&1&&(d(),n(0,"g"),m(1,J,2,1,"g",10),o()),r&2){let e=t.$implicit;a(),l("ngForOf",e.gpus)}}function Z(r,t){r&1&&(d(),c(0,"circle",18))}function ee(r,t){if(r&1&&(d(),c(0,"circle",19)),r&2){let e=t.$implicit;b("cx",e.startX+(e.targetX-e.startX)*(e.progress/100)+"%")("cy",e.startY+(e.targetY-e.startY)*(e.progress/100)+"%")}}function te(r,t){if(r&1&&(n(0,"div",35),c(1,"fa-icon",36),o()),r&2){let e=p().$implicit,i=p(2);a(),h("animation","spin "+2e3/(e.fansSpeed+10)+"ms linear infinite")("opacity",.5+e.fansSpeed/200),l("icon",i.faWind)}}function ie(r,t){if(r&1&&(n(0,"div",28,2)(2,"div",29)(3,"span",30),f(4),o(),n(5,"span"),f(6),I(7,"number"),o()(),n(8,"div",31),m(9,te,2,5,"div",32),o(),n(10,"div",33),c(11,"div",34),o()()),r&2){let e=t.$implicit;h("background-color",e.color)("box-shadow",e.active?"0 0 15px "+e.color:"none"),a(4),_(e.name),a(2),F("",O(7,11,e.load,"1.0-0"),"%"),a(3),l("ngForOf",k(14,L)),a(2),h("width",e.load,"%")("background-color",e.load>80?"#ef4444":e.load>50?"#eab308":"#22c55e")}}function re(r,t){if(r&1&&(n(0,"div",20)(1,"div",21)(2,"div",22),c(3,"fa-icon",23),n(4,"span",24),f(5),o()(),n(6,"div",25),f(7,"ONLINE"),o()(),n(8,"div",26),m(9,ie,12,15,"div",27),o()()),r&2){let e=t.$implicit,i=p();a(3),l("icon",i.faServer),a(2),_(e.id),a(4),l("ngForOf",e.gpus)}}var N=class r{constructor(t){this.cdr=t}rackContainer;switchElement;gpuElements;faServer=H;faMicrochip=Q;faNetworkWired=z;faWind=A;servers=[];packets=[];simulationInterval;animationFrameId;switchPos={x:50,y:10};ngOnInit(){this.initializeRack()}ngAfterViewInit(){setTimeout(()=>{this.calculatePositions(),this.startSimulation()},500)}onResize(){this.calculatePositions()}ngOnDestroy(){this.simulationInterval&&clearInterval(this.simulationInterval),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}initializeRack(){for(let t=0;t<4;t++){let e=[];for(let i=0;i<3;i++)e.push({id:`gpu-${t}-${i}`,name:"RTX 4090",load:0,temperature:30,fansSpeed:0,active:!1,color:"rgba(200, 200, 200, 0.1)"});this.servers.push({id:`server-${t}`,gpus:e})}}calculatePositions(){if(!this.rackContainer||!this.switchElement||!this.gpuElements)return;let t=this.rackContainer.nativeElement.getBoundingClientRect(),e=this.switchElement.nativeElement.getBoundingClientRect();this.switchPos={x:(e.left+e.width/2-t.left)/t.width*100,y:(e.top+e.height/2-t.top)/t.height*100};let i=this.gpuElements.toArray(),s=0;this.servers.forEach(w=>{w.gpus.forEach(u=>{if(s<i.length){let g=i[s].nativeElement.getBoundingClientRect();u.x=(g.left+g.width/2-t.left)/t.width*100,u.y=(g.top+g.height/2-t.top)/t.height*100,s++}})})}startSimulation(){this.simulationInterval=setInterval(()=>{this.generateTraffic(),this.updateHardwarePhysics()},100);let t=()=>{this.updatePackets(),this.animationFrameId=requestAnimationFrame(t)};t()}generateTraffic(){if(Math.random()>.7){let t=this.servers[Math.floor(Math.random()*this.servers.length)],e=t.gpus[Math.floor(Math.random()*t.gpus.length)];this.packets.push({id:Date.now()+Math.random(),startX:this.switchPos.x,startY:this.switchPos.y,targetX:e.x||50,targetY:e.y||50,progress:0,targetGpuId:e.id})}}updatePackets(){for(let e=this.packets.length-1;e>=0;e--){let i=this.packets[e];i.progress+=2,i.progress>=100&&(this.processPacketHit(i.targetGpuId),this.packets.splice(e,1))}this.cdr.detectChanges()}processPacketHit(t){for(let e of this.servers){let i=e.gpus.find(s=>s.id===t);if(i){i.load=Math.min(100,i.load+20),i.active=!0;break}}}updateHardwarePhysics(){this.servers.forEach(t=>{t.gpus.forEach(e=>{e.load=Math.max(0,e.load-2);let i=30+e.load*.6;if(e.temperature+=(i-e.temperature)*.1,e.fansSpeed=Math.max(0,(e.temperature-30)*1.5),e.load<5)e.color="rgba(226, 232, 240, 0.2)",e.active=!1;else{let s=Math.max(0,120-e.load*1.2),w=60,u=.5+e.load/200;e.color=`hsla(${s}, 80%, ${w}%, ${u})`}})})}static \u0275fac=function(e){return new(e||r)(E(M))};static \u0275cmp=P({type:r,selectors:[["app-physical-server-rack"]],viewQuery:function(e,i){if(e&1&&(v(X,5),v(B,5),v(W,5)),e&2){let s;x(s=y())&&(i.rackContainer=s.first),x(s=y())&&(i.switchElement=s.first),x(s=y())&&(i.gpuElements=s)}},hostBindings:function(e,i){e&1&&R("resize",function(){return i.onResize()},C)},decls:15,vars:6,consts:[["rackContainer",""],["switchElement",""],["gpuElement",""],[1,"w-full","min-h-full","bg-white","p-2","sm:p-4","rounded-xl","overflow-hidden","relative","flex","flex-col","items-center","border","border-slate-200","shadow-lg"],[1,"absolute","inset-0","opacity-30","pointer-events-none",2,"background-image","radial-gradient(#cbd5e1 1px, transparent 1px)","background-size","20px 20px"],[1,"relative","z-10","w-full","max-w-xs","sm:w-64","h-12","bg-white","border","border-slate-200","rounded-lg","shadow-md","flex","items-center","justify-between","px-4","mb-8","shrink-0"],[1,"flex","gap-1"],["class","w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full bg-gray-300 animate-pulse",3,"animation-delay",4,"ngFor","ngForOf"],[1,"text-[10px]","sm:text-xs","font-mono","text-unrender-purple","font-bold"],[1,"absolute","inset-0","w-full","h-full","pointer-events-none","z-0"],[4,"ngFor","ngForOf"],["r","3","fill","#818cf8","filter","url(#glow)",4,"ngFor","ngForOf"],["r","3","fill","#6366f1",4,"ngFor","ngForOf"],[1,"relative","z-10","w-full","max-w-4xl","flex-1","flex","flex-col","gap-4","p-2","sm:p-4","bg-gray-50","border","border-slate-200","rounded-xl","backdrop-blur-sm","shadow-sm","overflow-y-auto"],["class","w-full bg-white border border-slate-200 rounded-lg p-2 flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4 shadow-sm",4,"ngFor","ngForOf"],[1,"w-1.5","h-1.5","sm:w-2","sm:h-2","rounded-full","bg-gray-300","animate-pulse"],["stroke","#cbd5e1","stroke-width","1","stroke-dasharray","4 4","opacity","0.5",4,"ngIf"],["stroke","#cbd5e1","stroke-width","1","stroke-dasharray","4 4","opacity","0.5"],["r","3","fill","#818cf8","filter","url(#glow)"],["r","3","fill","#6366f1"],[1,"w-full","bg-white","border","border-slate-200","rounded-lg","p-2","flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-2","sm:gap-4","shadow-sm"],[1,"w-full","sm:w-24","flex","sm:flex-col","items-center","justify-between","sm:justify-center","border-b","sm:border-b-0","sm:border-r","border-slate-200","pb-2","sm:pb-0","sm:pr-2"],[1,"flex","items-center","gap-2","sm:flex-col"],[1,"text-slate-400","text-lg","sm:text-xl","mb-0","sm:mb-1",3,"icon"],[1,"text-[10px]","font-mono","text-slate-500"],[1,"sm:hidden","text-[10px]","text-slate-400"],[1,"w-full","grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-2","sm:gap-4"],["class","relative rounded border border-slate-200 p-2 flex flex-col items-center justify-between transition-colors duration-300 min-h-[100px]",3,"background-color","box-shadow",4,"ngFor","ngForOf"],[1,"relative","rounded","border","border-slate-200","p-2","flex","flex-col","items-center","justify-between","transition-colors","duration-300","min-h-[100px]"],[1,"w-full","flex","justify-between","items-center","text-[9px]","font-mono","text-slate-600","mb-1"],[1,"truncate","max-w-[80px]"],[1,"flex","gap-1","sm:gap-2","items-center","justify-center","flex-1","w-full","py-1"],["class","w-6 h-6 sm:w-8 sm:h-8 rounded-full border border-slate-200 flex items-center justify-center relative overflow-hidden bg-gray-100 shrink-0",4,"ngFor","ngForOf"],[1,"w-full","h-1","bg-gray-200","rounded-full","mt-1","overflow-hidden"],[1,"h-full","transition-all","duration-300"],[1,"w-6","h-6","sm:w-8","sm:h-8","rounded-full","border","border-slate-200","flex","items-center","justify-center","relative","overflow-hidden","bg-gray-100","shrink-0"],[1,"text-slate-400","text-[10px]","sm:text-sm","transition-transform",3,"icon"]],template:function(e,i){e&1&&(n(0,"div",3,0),c(2,"div",4),n(3,"div",5,1)(5,"div",6),m(6,q,1,2,"div",7),o(),n(7,"div",8),f(8,"CORE-SWITCH-01"),o()(),d(),n(9,"svg",9),m(10,K,2,1,"g",10)(11,Z,1,0,"circle",11)(12,ee,1,2,"circle",12),o(),S(),n(13,"div",13),m(14,re,10,3,"div",14),o()()),e&2&&(a(6),l("ngForOf",k(5,Y)),a(4),l("ngForOf",i.servers),a(),l("ngForOf",i.packets),a(),l("ngForOf",i.packets),a(2),l("ngForOf",i.servers))},dependencies:[G,T,$,V,j,D],styles:["@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}[_nghost-%COMP%]{display:block;height:100%;width:100%}"]})};export{N as PhysicalServerRackComponent};
