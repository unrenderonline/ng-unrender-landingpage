import{K as N,La as B,Oa as L,Ua as j,aa as $,la as D,p as P,ua as Q}from"./chunk-APBCXCJV.js";import{a as F,b as A}from"./chunk-2PWV3ZRO.js";import"./chunk-7NMITLUU.js";import{i as _,k as E,l as M,p as O,r as G}from"./chunk-X7Q72NDQ.js";import{$a as k,$b as m,Bb as l,Cb as n,Db as a,Eb as d,Lb as C,Oa as r,Pb as T,Rb as g,Xb as v,Yb as h,_b as s,ac as u,ca as S,da as w,eb as f,hc as I,lc as b,nc as y}from"./chunk-Z4PMJ25B.js";var z=o=>({"opacity-60 grayscale":o});function R(o,t){if(o&1&&(n(0,"div",35),d(1,"div",36),n(2,"div",37)(3,"div",2),d(4,"fa-icon",38),n(5,"span",39),s(6),a()(),d(7,"fa-icon",40),a(),n(8,"div",41)(9,"div",6),d(10,"fa-icon",42),s(11),b(12,"number"),a(),n(13,"div"),s(14),a()(),n(15,"div",43),d(16,"div",44),n(17,"span",45),s(18),a()()()),o&2){let e=t.$implicit,i=g(2);r(),v("width",e.load,"%"),r(3),l("icon",i.faMicrochip),r(2),m(e.name),r(),h("text-yellow-400",e.status==="working")("text-slate-300",e.status==="idle"),l("icon",i.faBolt),r(3),l("icon",i.faTemperatureHigh),r(),u(" ",y(12,15,e.temp,"1.0-0"),"\xB0C "),r(3),u("MEM: ",e.memory,"GB"),r(2),v("width",e.load,"%"),r(2),u(" ",e.currentTask||"Ocioso - Aguardando..."," ")}}function U(o,t){if(o&1){let e=C();n(0,"div",24)(1,"div",25)(2,"div",26),d(3,"fa-icon",27),n(4,"span",28),s(5),a(),n(6,"span",29),s(7),a()(),n(8,"div",30)(9,"div",31),s(10),b(11,"number"),a(),n(12,"button",32),T("click",function(){let c=S(e).$implicit,p=g();return w(p.toggleServerStatus(c))}),s(13),a()()(),n(14,"div",33),f(15,R,19,18,"div",34),a()()}if(o&2){let e=t.$implicit,i=g();l("ngClass",I(14,z,e.status==="offline")),r(3),h("text-green-500",e.status==="online")("text-red-500",e.status==="offline"),l("icon",i.faServer),r(2),m(e.name),r(2),m(e.status),r(3),u("CPU: ",y(11,11,e.cpuLoad,"1.0-0"),"%"),r(3),u(" ",e.status==="online"?"Simular Falha":"Reiniciar"," "),r(2),l("ngForOf",e.gpus)}}function V(o,t){if(o&1&&(n(0,"div",46)(1,"div",47)(2,"span",48),s(3),a(),n(4,"span",49),s(5),a()(),n(6,"div",50),d(7,"div",51),a(),n(8,"div",52)(9,"span"),s(10),a(),n(11,"span"),s(12),a()()()),o&2){let e=t.$implicit;r(3),m(e.name),r(2),m(e.id),r(2),v("width",e.progress,"%"),r(3),m(e.assignedTo?"Processando em "+e.assignedTo:"Aguardando aloca\xE7\xE3o..."),r(2),u("",e.progress,"%")}}function W(o,t){o&1&&(n(0,"div",53),s(1," Nenhuma tarefa pendente "),a())}function K(o,t){if(o&1&&(n(0,"div",54),d(1,"fa-icon",55),n(2,"span",56),s(3),a(),n(4,"span",57),s(5),a()()),o&2){let e=t.$implicit,i=g();r(),l("icon",i.faCheckCircle),r(2),m(e.name),r(2),m(e.id)}}var H=class o{faServer=$;faMicrochip=L;faNetworkWired=N;faBolt=B;faTemperatureHigh=P;faCheckCircle=D;faExclamationTriangle=Q;faSync=j;servers=[];taskQueue=[];completedTasks=[];simulationInterval;taskGeneratorInterval;ngOnInit(){this.initializeCluster(),this.startSimulation()}ngOnDestroy(){this.simulationInterval&&clearInterval(this.simulationInterval),this.taskGeneratorInterval&&clearInterval(this.taskGeneratorInterval)}initializeCluster(){for(let t=1;t<=3;t++){let e=[];for(let i=1;i<=2;i++)e.push({id:`gpu-${t}-${i}`,name:`RTX 4090 #${i}`,load:0,temp:35,memory:0,status:"idle"});this.servers.push({id:`server-${t}`,name:`AI-NODE-0${t}`,status:"online",gpus:e,cpuLoad:10,ramUsage:16})}}startSimulation(){this.simulationInterval=setInterval(()=>{this.processTasks(),this.updateHardwareStats()},200),this.taskGeneratorInterval=setInterval(()=>{this.taskQueue.length<10&&this.generateTask()},2e3)}generateTask(){let t=["Treinamento de Lote","Infer\xEAncia YOLOv8","Processamento de Dados","Valida\xE7\xE3o de Modelo","Renderiza\xE7\xE3o NeRF"],e=t[Math.floor(Math.random()*t.length)],i=Math.random().toString(36).substr(2,5).toUpperCase();this.taskQueue.push({id:`TASK-${i}`,name:e,complexity:Math.floor(Math.random()*50)+50,progress:0})}processTasks(){let t=this.getAllGpus().filter(i=>i.status==="idle"&&this.getServerOfGpu(i.id)?.status==="online");this.taskQueue.filter(i=>!i.assignedTo).forEach(i=>{if(t.length>0){t.sort((p,x)=>p.temp-x.temp);let c=t.shift();c&&(c.status="working",c.currentTask=i.name,i.assignedTo=c.id)}}),this.taskQueue.forEach((i,c)=>{if(i.assignedTo){let p=this.getGpuById(i.assignedTo),x=this.getServerOfGpu(i.assignedTo);if(!x||x.status!=="online"){i.assignedTo=void 0;return}p&&(i.progress+=5,p.load=Math.min(100,p.load+10),p.temp=Math.min(85,p.temp+.5),p.memory=Math.min(80,p.memory+2),i.progress>=100&&this.completeTask(c,p))}})}completeTask(t,e){let i=this.taskQueue[t];this.completedTasks.unshift(i),this.completedTasks.length>5&&this.completedTasks.pop(),this.taskQueue.splice(t,1),e.status="idle",e.currentTask=void 0,e.load=0}updateHardwareStats(){this.servers.forEach(t=>{t.status==="online"?(t.gpus.forEach(e=>{e.status==="idle"&&(e.temp=Math.max(35,e.temp-1),e.memory=Math.max(0,e.memory-5))}),t.cpuLoad=Math.max(5,Math.min(100,t.cpuLoad+(Math.random()*10-5)))):(t.cpuLoad=0,t.gpus.forEach(e=>{e.load=0,e.temp=Math.max(20,e.temp-2)}))})}getAllGpus(){return this.servers.flatMap(t=>t.gpus)}getGpuById(t){return this.getAllGpus().find(e=>e.id===t)}getServerOfGpu(t){return this.servers.find(e=>e.gpus.some(i=>i.id===t))}toggleServerStatus(t){t.status=t.status==="online"?"offline":"online"}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=k({type:o,selectors:[["app-ai-server-cluster"]],decls:33,vars:6,consts:[[1,"w-full","h-full","bg-white","text-slate-700","p-4","rounded-xl","font-mono","overflow-hidden","flex","flex-col","gap-4","border","border-slate-200","shadow-lg"],[1,"flex","justify-between","items-center","border-b","border-slate-200","pb-2"],[1,"flex","items-center","gap-2"],[1,"text-unrender-purple",3,"icon"],[1,"font-bold","text-lg","text-unrender-purple"],[1,"flex","gap-4","text-xs"],[1,"flex","items-center","gap-1"],[1,"w-2","h-2","rounded-full","bg-green-500"],[1,"w-2","h-2","rounded-full","bg-red-500"],[1,"w-2","h-2","rounded-full","bg-yellow-500"],[1,"flex-1","grid","grid-cols-1","lg:grid-cols-3","gap-4","overflow-hidden"],[1,"lg:col-span-2","flex","flex-col","gap-3","overflow-y-auto","pr-2"],["class","bg-white rounded-lg border border-slate-200 p-3 transition-all duration-300 shadow-sm",3,"ngClass",4,"ngFor","ngForOf"],[1,"flex","flex-col","gap-4"],[1,"bg-white","rounded-lg","border","border-slate-200","p-3","flex-1","flex","flex-col","shadow-sm"],[1,"text-xs","font-bold","text-slate-500","uppercase","mb-2","flex","justify-between"],[1,"bg-unrender-purple","text-white","px-1.5","rounded-full"],[1,"flex-1","overflow-y-auto","space-y-2","pr-1","custom-scrollbar"],["class","bg-gray-50 p-2 rounded border-l-2 border-unrender-purple text-xs shadow-sm",4,"ngFor","ngForOf"],["class","text-center text-slate-400 text-xs py-4",4,"ngIf"],[1,"bg-white","rounded-lg","border","border-slate-200","p-3","h-1/3","flex","flex-col","shadow-sm"],[1,"text-xs","font-bold","text-slate-500","uppercase","mb-2"],[1,"overflow-y-auto","space-y-1","pr-1","custom-scrollbar"],["class","flex items-center gap-2 text-xs text-slate-600",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","border","border-slate-200","p-3","transition-all","duration-300","shadow-sm",3,"ngClass"],[1,"flex","justify-between","items-center","mb-3"],[1,"flex","items-center","gap-2","min-w-0","flex-1","mr-2"],[1,"shrink-0",3,"icon"],[1,"font-bold","text-slate-800","truncate"],[1,"text-[10px]","sm:text-xs","px-2","py-0.5","rounded","bg-gray-100","uppercase","text-slate-600","border","border-slate-200","shrink-0"],[1,"flex","items-center","gap-2","sm:gap-4","shrink-0"],[1,"text-[10px]","sm:text-xs","text-slate-500","hidden","sm:block"],[1,"text-[10px]","sm:text-xs","px-2","py-1","rounded","border","border-slate-200","hover:bg-gray-50","transition-colors","text-slate-600","whitespace-nowrap",3,"click"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-3"],["class","bg-gray-50 rounded p-2 border border-slate-200 relative overflow-hidden",4,"ngFor","ngForOf"],[1,"bg-gray-50","rounded","p-2","border","border-slate-200","relative","overflow-hidden"],[1,"absolute","top-0","left-0","h-1","bg-gradient-to-r","from-green-500","to-yellow-500","transition-all","duration-300"],[1,"flex","justify-between","items-start","mb-2"],[1,"text-slate-400",3,"icon"],[1,"text-xs","font-bold","text-slate-700"],[1,"text-xs","animate-pulse",3,"icon"],[1,"grid","grid-cols-2","gap-2","text-[10px]","text-slate-500","mb-2"],[3,"icon"],[1,"h-6","bg-white","border","border-slate-200","rounded","flex","items-center","px-2","text-[10px]","relative","overflow-hidden"],[1,"absolute","left-0","top-0","h-full","bg-unrender-purple/10","transition-all","duration-300"],[1,"relative","z-10","truncate","w-full","text-slate-600"],[1,"bg-gray-50","p-2","rounded","border-l-2","border-unrender-purple","text-xs","shadow-sm"],[1,"flex","justify-between","mb-1"],[1,"font-bold","truncate","text-slate-700"],[1,"text-slate-400"],[1,"w-full","bg-gray-200","h-1.5","rounded-full","overflow-hidden"],[1,"bg-unrender-purple","h-full","transition-all","duration-300"],[1,"flex","justify-between","mt-1","text-[10px]","text-slate-500"],[1,"text-center","text-slate-400","text-xs","py-4"],[1,"flex","items-center","gap-2","text-xs","text-slate-600"],[1,"text-green-500",3,"icon"],[1,"truncate"],[1,"ml-auto","text-slate-400"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),d(3,"fa-icon",3),n(4,"h2",4),s(5,"Gerenciador de Cluster IA"),a()(),n(6,"div",5)(7,"div",6),d(8,"span",7),s(9," Online "),a(),n(10,"div",6),d(11,"span",8),s(12," Offline "),a(),n(13,"div",6),d(14,"span",9),s(15," Ocupado "),a()()(),n(16,"div",10)(17,"div",11),f(18,U,16,16,"div",12),a(),n(19,"div",13)(20,"div",14)(21,"h3",15),s(22," Fila de Tarefas "),n(23,"span",16),s(24),a()(),n(25,"div",17),f(26,V,13,6,"div",18)(27,W,2,0,"div",19),a()(),n(28,"div",20)(29,"h3",21),s(30,"Tarefas Conclu\xEDdas"),a(),n(31,"div",22),f(32,K,6,3,"div",23),a()()()()()),e&2&&(r(3),l("icon",i.faNetworkWired),r(15),l("ngForOf",i.servers),r(6),m(i.taskQueue.length),r(2),l("ngForOf",i.taskQueue),r(),l("ngIf",i.taskQueue.length===0),r(5),l("ngForOf",i.completedTasks))},dependencies:[G,_,E,M,A,F,O],styles:[".custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000001a}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ffffff1a;border-radius:2px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#fff3}[_nghost-%COMP%]{display:block;height:100%;width:100%}"]})};export{H as AiServerClusterComponent};
